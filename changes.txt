Added modify checkbox
changed default for Create Tree/Container INformation to "UnChecked"
Changed Port from the default 636(secure) to 389 (non-secure)



Private Declare Function OpenProcess Lib "kernel32" (ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long
Private Declare Function GetExitCodeProcess Lib "kernel32" (ByVal hProcess As Long, lpExitCode As Long) As Long
Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
Const STILL_ACTIVE = &H103
Const PROCESS_QUERY_INFORMATION = &H400

Private Sub CfgBrowse_Click()
cmnDialog.FileName = Text32.Text
cmnDialog.ShowOpen
Text32.Text = cmnDialog.FileName
If Text32.Text = "" Then Text32.Text = "C:\Temp\TreeBuilder.conf"
End Sub

Private Sub InstallCleanup_Click()
InstCleaner.Show
End Sub

Private Sub HelpRead_Click()
RetVal = ShellExecute(0, "open", "iexplore", "http://st12.provo.novell.com/vol1/TreeBuilder/TreeBuilderReadme.html", "", SW_SHOW)
End Sub

Private Sub QS_Click()
QuickSTart.Show
End Sub

Private Sub CustomCheck_Click()
If CustomCheck = 1 Then RetrieveTreeCheck = 0
If CustomCheck = 1 Then CheckAdd = 0
If CustomCheck = 1 Then CheckDel = 0
End Sub

Private Sub ReadConfig_Click()

On Error GoTo ErrorHandler
    Dim A$, i As Integer, P$, k As Integer, B$
    Dim ConfigFile As String
    Dim Num_Apps As Integer, NewFile As Integer
    Dim File_Data As String, DosCmd As String
    Dim MyText As String
    Dim ParsedText
    
    ConfigFile = Text32.Text
    NewFile = FreeFile 'Display the filenames in the Text Box.
    MyText = ""

On Error GoTo ErrorHandler
    Sleep 100
    Do While FileExists(ConfigFile) = "False" 'Make sure the file exists
    DoEvents: Sleep 100
    Loop
Open ConfigFile For Input As #NewFile
   ParsedText = "'"
      While Not EOF(NewFile)
      Line Input #NewFile, File_Data
   ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1.Text = MyText
            
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo1.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text2.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text3.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text14.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text31.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text4.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text6.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text7.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      StopOnErrCheck = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text30.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      AnonCheck = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      RetrieveTreeCheck = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo2.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo6.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      CheckAdd = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      CheckDel = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text5.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text6.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text7.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text19.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      CustomCheck = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text30.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      UserHomeCheck = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      SelectAllUserSetCheck = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      UserSetOneCheck = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      UserSetTwoCheck = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      UserSetThreeCheck = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      UserSetFourCheck = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text10.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text15.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text20.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text25.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text11.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text16.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text21.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text26.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text12.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text17.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text22.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text27.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text13.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text18.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text23.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text28.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo14.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      CustContCheck = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      AppDomCheck1 = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text29.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      SkipTreeCreateCheck = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text100.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text101.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text102.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text103.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text104.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text105.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text106.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text107.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text108.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text109.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text110.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text111.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text112.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text113.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text114.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text115.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text8.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text9.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo199.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text200.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1101.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1201.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1301.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1401.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1501.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1601.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1102.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1202.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1302.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1402.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1502.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1602.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1103.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1203.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1303.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1403.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1503.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text1603.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo104.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo204.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo304.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo404.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo504.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo604.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo105.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo205.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo305.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo405.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo505.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo605.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo106.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo206.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo306.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo406.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo506.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Combo606.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text401.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text403.Text = MyText
      
      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text404.Text = MyText

      Line Input #NewFile, File_Data
      ParsedText = File_Data
      A$ = ParsedText
      MyText = CVar(A$)
      Text405.Text = MyText
   
   Wend
Close #NewFile   ' Close file.

On Error GoTo ErrorResume   'Resume next in case file is locked
ErrorResume:
Resume Next   'in case file is locked
ErrorHandler:
If Err.Description = "" Then Resume Next Else MsgBox Err.Description
End Sub

Private Sub ResetAll_Click()
On Error GoTo ErrorHandler

   Text1.Text = "255.255.255.255"
   Combo1.Text = "636"
   AnonCheck = 0
   RetrieveTreeCheck = 0
   Text2.Text = "cn=admin,o=novell"
   Text3.Text = "test"
   Text14.Text = "o=Novell"
   Text31.Text = "sub"
   Combo2.Text = "1"
   Combo6.Text = "NDS 8"
   CheckAdd = 1
   CheckDel = 0
   StopOnErrCheck = 0
   Text4.Text = "F:\Public\Rootcert.der"
   Text5.Text = "C:\temp\rice.bat"
   Text6.Text = "C:\Temp\ldif_exp.txt"
   Text7.Text = "C:\Temp\ldif_imp.txt"
   Text19.Text = "C:\Temp\"
   CustomCheck = 0
   Text30.Text = "C:\Temp\ldif_cust.txt"
   UserHomeCheck = 0
   SelectAllUserSetCheck = 0
   UserSetOneCheck = 1
   UserSetTwoCheck = 0
   UserSetThreeCheck = 0
   UserSetFourCheck = 0
   Text10.Text = "ProvoTestUser"
   Text11.Text = "John"
   Text12.Text = "Doe"
   Text13.Text = "test"
   Text15.Text = "BostonTestUser"
   Text16.Text = "Jack"
   Text17.Text = "Malone"
   Text18.Text = "test"
   Text20.Text = "BangaloreTestUser"
   Text21.Text = "Sudarshan"
   Text22.Text = "Sarkar"
   Text23.Text = "test"
   Text25.Text = "DublinTestUser"
   Text26.Text = "Patrick"
   Text27.Text = "O'Hare"
   Text28.Text = "test"
   Combo14.Text = "No"
   CustContCheck = 0
   AppDomCheck1 = 0
   Text29.Text = ",ou=Provo,o=novell"
   Text32.Text = "C:\temp\TreeBuilder.conf"
   SkipTreeCreateCheck = 1
   Text100.Text = "Users"
   Text101.Text = "Engineering"
   Text102.Text = "Provo"
   Text103.Text = "Novell"
   Text104.Text = "Users"
   Text105.Text = "Accounting"
   Text106.Text = "Boston"
   Text107.Text = "Novell"
   Text108.Text = "Users"
   Text109.Text = "ProtocolEngineering"
   Text110.Text = "Bangalore"
   Text111.Text = "Novell"
   Text112.Text = "Users"
   Text113.Text = "Internationalization"
   Text114.Text = "Dublin"
   Text115.Text = "Novell"
   Text8.Text = "mh.novell.com"
   Text9.Text = "novell.com"
   Combo199.Text = ""
   Text200.Text = "Novell"
   Text1101.Text = "Boston"
   Text1102.Text = "Accounting"
   Text1103.Text = "Users"
   Combo104.Text = "Level4Users"
   Combo105.Text = "Level5Users"
   Combo106.Text = "Level6Users"
   Text1201.Text = "Dublin"
   Text1202.Text = "Internationalization"
   Text1203.Text = "Users"
   Combo204.Text = "Level4Users"
   Combo205.Text = "Level5Users"
   Combo206.Text = "Level6Users"
   Text1301.Text = "Provo"
   Text1302.Text = "Engineering"
   Text1303.Text = "Users"
   Combo304.Text = "Level4Users"
   Combo305.Text = "Level5Users"
   Combo306.Text = "Level6Users"
   Text1401.Text = "Bangalore"
   Text1402.Text = "ProtocolEngineering"
   Text1403.Text = "Users"
   Combo404.Text = "Level4Users"
   Combo405.Text = "Level5Users"
   Combo406.Text = "Level6Users"
   Text1501.Text = "Cambridge"
   Text1502.Text = "Marketing"
   Text1503.Text = "Users"
   Combo504.Text = "Level4Users"
   Combo505.Text = "Level5Users"
   Combo506.Text = "Level6Users"
   Text1601.Text = "Level1DuesseldorfFullDepthContainer"
   Text1602.Text = "Level2FullDepthContainer"
   Text1603.Text = "Level3FullDepthContainer"
   Combo604.Text = "Level4FullDepthContainer"
   Combo605.Text = "Level5FullDepthContainer"
   Combo606.Text = "Level6FullDepthContainerFullDepthContainerFullDepth"
   Text401.Text = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory"
   Text403.Text = "C:\Users\"
   Text404.Text = "public_html"
   Text405.Text = "index.html"
   
On Error GoTo ErrorResume   'Resume next in case file is locked
ErrorResume:
Resume Next   'in case file is locked
ErrorHandler:
If Err.Description = "" Then Resume Next Else MsgBox Err.Description
End Sub

Private Sub SaveConfig_Click()
      Dim TBConfigFile As String

      TBConfigFile = Text32.Text
   
On Error GoTo ErrorHandler

   Open TBConfigFile For Output As #1 '***File Open***

            Print #1, Text1.Text
            Print #1, Combo1.Text
            Print #1, Text2.Text
            Print #1, Text3.Text
            Print #1, Text14.Text
            Print #1, Text31.Text
            Print #1, Text4.Text
            Print #1, Text6.Text
            Print #1, Text7.Text
            Print #1, (StopOnErrCheck)
            Print #1, Text30.Text
            Print #1, (AnonCheck)
            Print #1, (RetrieveTreeCheck)
            Print #1, Combo2.Text
            Print #1, Combo6.Text
            Print #1, (CheckAdd)
            Print #1, (CheckDel)
            Print #1, Text5.Text
            Print #1, Text6.Text
            Print #1, Text7.Text
            Print #1, Text19.Text
            Print #1, (CustomCheck)
            Print #1, Text30.Text
            Print #1, (UserHomeCheck)
            Print #1, (SelectAllUserSetCheck)
            Print #1, (UserSetOneCheck)
            Print #1, (UserSetTwoCheck)
            Print #1, (UserSetThreeCheck)
            Print #1, (UserSetFourCheck)
            Print #1, Text10.Text
            Print #1, Text15.Text
            Print #1, Text20.Text
            Print #1, Text25.Text
            Print #1, Text11.Text
            Print #1, Text16.Text
            Print #1, Text21.Text
            Print #1, Text26.Text
            Print #1, Text12.Text
            Print #1, Text17.Text
            Print #1, Text22.Text
            Print #1, Text27.Text
            Print #1, Text13.Text
            Print #1, Text18.Text
            Print #1, Text23.Text
            Print #1, Text28.Text
            Print #1, Combo14.Text
            Print #1, (CustContCheck)
            Print #1, (AppDomCheck1)
            Print #1, Text29.Text
            Print #1, (SkipTreeCreateCheck)
            Print #1, Text100.Text
            Print #1, Text101.Text
            Print #1, Text102.Text
            Print #1, Text103.Text
            Print #1, Text104.Text
            Print #1, Text105.Text
            Print #1, Text106.Text
            Print #1, Text107.Text
            Print #1, Text108.Text
            Print #1, Text109.Text
            Print #1, Text110.Text
            Print #1, Text111.Text
            Print #1, Text112.Text
            Print #1, Text113.Text
            Print #1, Text114.Text
            Print #1, Text115.Text
            Print #1, Text8.Text
            Print #1, Text9.Text
            Print #1, Combo199.Text
            Print #1, Text200.Text
            Print #1, Text1101.Text
            Print #1, Text1201.Text
            Print #1, Text1301.Text
            Print #1, Text1401.Text
            Print #1, Text1501.Text
            Print #1, Text1601.Text
            Print #1, Text1102.Text
            Print #1, Text1202.Text
            Print #1, Text1302.Text
            Print #1, Text1402.Text
            Print #1, Text1502.Text
            Print #1, Text1602.Text
            Print #1, Text1103.Text
            Print #1, Text1203.Text
            Print #1, Text1303.Text
            Print #1, Text1403.Text
            Print #1, Text1503.Text
            Print #1, Text1603.Text
            Print #1, Combo104.Text
            Print #1, Combo204.Text
            Print #1, Combo304.Text
            Print #1, Combo404.Text
            Print #1, Combo504.Text
            Print #1, Combo604.Text
            Print #1, Combo105.Text
            Print #1, Combo205.Text
            Print #1, Combo305.Text
            Print #1, Combo405.Text
            Print #1, Combo505.Text
            Print #1, Combo605.Text
            Print #1, Combo106.Text
            Print #1, Combo206.Text
            Print #1, Combo306.Text
            Print #1, Combo406.Text
            Print #1, Combo506.Text
            Print #1, Combo606.Text
            Print #1, Text401.Text
            Print #1, Text403.Text
            Print #1, Text404.Text
            Print #1, Text405.Text
   Close #1
   
On Error GoTo ErrorResume   'Resume next in case file is locked
ErrorResume:
Resume Next   'in case file is locked
ErrorHandler:
If Err.Description = "" Then Resume Next Else MsgBox Err.Description
End Sub

Private Sub UHDReset_Click()
Text401.Text = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory"
End Sub

Private Sub UserHomeCheck_Click()
If UserHomeCheck = 1 Then frmOptions.SSTab1.Tab = 3
End Sub

Private Sub StopOnErrCheck_Click()
If StopOnErrCheck = 1 Then StopOnErr = ""
If StopOnErrCheck = 0 Then StopOnErr = "-c"
End Sub

Private Sub RetrieveTreeCheck_Click()
If RetrieveTreeCheck = 1 Then CustomCheck = 0
If RetrieveTreeCheck = 1 Then CheckAdd = 0
If RetrieveTreeCheck = 1 Then CheckDel = 0
End Sub

Private Sub CheckAdd_Click()
If CheckAdd = 1 Then CheckDel = 0
If CheckAdd = 1 Then RetrieveTreeCheck = 0
If CheckAdd = 1 Then CType = "add"
If CheckAdd = 0 Then CType = "delete"
If CheckAdd = 1 Then CustomCheck = 0
End Sub

Private Sub CheckDel_Click()
If CheckDel = 1 Then CheckAdd = 0
If CheckDel = 1 Then RetrieveTreeCheck = 0
If CheckDel = 1 Then CustomCheck = 0
End Sub

Private Sub AnonCheck_Click()
If AnonCheck = 1 Then Combo1.Text = "389"
If AnonCheck = 1 Then Text2.Text = ""
If AnonCheck = 1 Then Text3.Text = ""
If AnonCheck = 1 Then Text4.Text = ""
If AnonCheck = 1 Then Text14.Text = ""
If AnonCheck = 1 Then Text31.Text = ""

'Reset Defaults
If AnonCheck = 0 Then Combo1.Text = "636"
If AnonCheck = 0 Then Text2.Text = "cn=admin,o=novell"
If AnonCheck = 0 Then Text3.Text = "test"
If AnonCheck = 0 Then Text4.Text = "F:\Public\Rootcert.der"
If AnonCheck = 0 Then Text14.Text = "o=Novell"
If AnonCheck = 0 Then Text31.Text = "sub"
End Sub

Private Sub SelectAllUserSetCheck_Click()
If SelectAllUserSetCheck = 1 Then UserSetOneCheck = 1
If SelectAllUserSetCheck = 1 Then UserSetTwoCheck = 1
If SelectAllUserSetCheck = 1 Then UserSetThreeCheck = 1
If SelectAllUserSetCheck = 1 Then UserSetFourCheck = 1
If SelectAllUserSetCheck = 0 Then UserSetOneCheck = 0
If SelectAllUserSetCheck = 0 Then UserSetTwoCheck = 0
If SelectAllUserSetCheck = 0 Then UserSetThreeCheck = 0
If SelectAllUserSetCheck = 0 Then UserSetFourCheck = 0
End Sub

Private Sub CustContCheck_Click()
If CustContCheck = 1 Then SelectAllUserSetCheck = 0
If CustContCheck = 1 Then UserSetOneCheck = 1
If CustContCheck = 1 Then UserSetTwoCheck = 0
If CustContCheck = 1 Then UserSetThreeCheck = 0
If CustContCheck = 1 Then UserSetFourCheck = 0
If CustContCheck = 0 Then SelectAllUserSetCheck = 0
If CustContCheck = 0 Then UserSetOneCheck = 1
If CustContCheck = 0 Then UserSetTwoCheck = 0
If CustContCheck = 0 Then UserSetThreeCheck = 0
If CustContCheck = 0 Then UserSetFourCheck = 0
End Sub

Private Sub AppDomCheck1_Click()
If AppDomCheck1 = 1 Then CustContCheck = 1
End Sub

Private Sub CmdBrowse1_Click()
cmnDialog.FileName = Text4.Text
cmnDialog.ShowOpen
Text4.Text = cmnDialog.FileName
If Text4.Text = "" Then Text4.Text = "F:\Public\Rootcert.der"
End Sub

Private Sub CmdBrowse10_Click()
cmnDialog.FileName = Text30.Text
cmnDialog.ShowOpen
Text30.Text = cmnDialog.FileName
If Text30.Text = "" Then Text30.Text = "C:\Temp\ldif_cust.txt"
End Sub

Private Sub CmdBrowse2_Click()
cmnDialog.FileName = Text5.Text
cmnDialog.ShowOpen
Text5.Text = cmnDialog.FileName
If Text5.Text = "" Then Text5.Text = "C:\temp\rice.bat"
End Sub

Private Sub CmdBrowse3_Click()
cmnDialog.FileName = Text6.Text
cmnDialog.ShowOpen
Text6.Text = cmnDialog.FileName
If Text6.Text = "" Then Text6.Text = "C:\Temp\ldif_exp.txt"
End Sub

Private Sub CmdBrowse4_Click()
cmnDialog.FileName = Text7.Text
cmnDialog.ShowOpen
Text7.Text = cmnDialog.FileName
If Text7.Text = "" Then Text7.Text = "C:\Temp\ldif_imp.txt"
End Sub

Private Sub CmdBrowse6_Click()
Dim getdir As String
    getdir = Text403.Text
        getdir = BrowseForFolder(Me, "Select A Directory to Create User Home Directories in", getdir)
    If Len(getdir) = 0 Then Exit Sub  'user selected cancel
    Text403.Text = getdir
End Sub

Private Sub cmdClean_Click()
   Dim RICEBatch As String
   Dim FileOut As String
   Dim filein As String
   Dim RetVal As Long
   
   RICEBatch = Text5.Text
   FileOut = Text6.Text
   filein = Text7.Text
   
   RetVal = DeleteFile(RICEBatch)
   RetVal = DeleteFile(FileOut)
   RetVal = DeleteFile(filein)
   RetVal = DeleteFile("ice.log")
   
End Sub

Private Sub cmdClose_Click()
Unload Me
End Sub

Private Sub cmdViewCust_Click()
      Dim RetVal As Long
      Dim filein As String
           
      filein = Text30.Text
      RetVal = ShellExecute(0, "open", "notepad", filein, "", SW_SHOW)
End Sub

Private Sub cmdViewExp_Click()
      Dim RetVal As Long
      Dim FileOut As String
      
      FileOut = Text6.Text
      
      RetVal = ShellExecute(0, "open", "notepad", FileOut, "", SW_SHOW)
End Sub

Private Sub CmdViewICE_Click()
      Dim RetVal As Long
      Dim ifilename As String
      Dim WPath
      WPath = Text19.Text
      ifilename = WPath + "ice.log"

      RetVal = ShellExecute(0, "open", "notepad", ifilename, "", SW_SHOW)
End Sub

Private Sub cmdViewImp_Click()
      Dim RetVal As Long
      Dim filein As String
           
      filein = Text7.Text
      RetVal = ShellExecute(0, "open", "notepad", filein, "", SW_SHOW)
End Sub

Private Sub CmdBrowse5_Click()
    Dim getdir As String
    getdir = Text19.Text
        getdir = BrowseForFolder(Me, "Select A Directory to write working files to.", getdir)
    If Len(getdir) = 0 Then Exit Sub  'user selected cancel
    Text19.Text = getdir
End Sub

Private Sub cmdViewRice_Click()
      Dim RetVal As Long
      Dim RICEBatch As String
            
      RICEBatch = Text5.Text
      RetVal = ShellExecute(0, "open", "notepad", RICEBatch, "", SW_SHOW)
End Sub

Private Sub Combo1_Change()
If Combo1.Text = "389" Then Text4.Text = ""
End Sub

Private Sub Text24_Change()
Text24.Text = "123456789012"
End Sub

Private Sub Text100_Change()
Text1303.Text = Text100.Text
End Sub

Private Sub Text101_Change()
Text1302.Text = Text101.Text
End Sub

Private Sub Text102_Change()
Text1301.Text = Text102.Text
End Sub

Private Sub Text104_Change()
Text1103.Text = Text104.Text
End Sub

Private Sub Text105_Change()
Text1102.Text = Text105.Text
End Sub

Private Sub Text106_Change()
Text1101.Text = Text106.Text
End Sub

Private Sub Text108_Change()
Text1403.Text = Text108.Text
End Sub

Private Sub Text109_Change()
Text1402.Text = Text109.Text
End Sub

Private Sub Text110_Change()
Text1401.Text = Text110.Text
End Sub

Private Sub Text112_Change()
Text1203.Text = Text112.Text
End Sub

Private Sub Text113_Change()
Text1202.Text = Text113.Text
End Sub

Private Sub Text114_Change()
Text1201.Text = Text114.Text
End Sub

Private Sub Text1101_Change()
Text106.Text = Text1101.Text
End Sub

Private Sub Text1102_Change()
Text105.Text = Text1102.Text
End Sub

Private Sub Text1103_Change()
Text104.Text = Text1103.Text
End Sub

Private Sub Text1201_Change()
Text114.Text = Text1201.Text
End Sub

Private Sub Text1202_Change()
Text113.Text = Text1202.Text
End Sub

Private Sub Text1203_Change()
Text112.Text = Text1203.Text
End Sub

Private Sub Text1301_Change()
Text102.Text = Text1301.Text
End Sub

Private Sub Text1302_Change()
Text101.Text = Text1302.Text
End Sub

Private Sub Text1303_Change()
Text100.Text = Text1303.Text
End Sub

Private Sub Text1401_Change()
Text110.Text = Text1401.Text
End Sub

Private Sub Text1402_Change()
Text109.Text = Text1402.Text
End Sub

Private Sub Text1403_Change()
Text108.Text = Text1403.Text
End Sub

Private Sub Text200_Change()
Text103.Text = Text200.Text
Text107.Text = Text200.Text
Text111.Text = Text200.Text
Text115.Text = Text200.Text
End Sub

Private Sub Text103_Change()
Text200.Text = Text103.Text
Text107.Text = Text103.Text
Text111.Text = Text103.Text
Text115.Text = Text103.Text
End Sub

Private Sub Text107_Change()
Text200.Text = Text107.Text
Text103.Text = Text107.Text
Text111.Text = Text107.Text
Text115.Text = Text107.Text
End Sub

Private Sub Text111_Change()
Text200.Text = Text111.Text
Text103.Text = Text111.Text
Text107.Text = Text111.Text
Text115.Text = Text111.Text
End Sub

Private Sub Text115_Change()
Text200.Text = Text115.Text
Text103.Text = Text115.Text
Text107.Text = Text115.Text
Text111.Text = Text115.Text
End Sub

Private Sub CmdUpdate_Click()
   
   Dim RICEBatch As String
   Dim FileOut As String
   Dim filein As String
   Dim beginval As Long
   Dim endval As Long
   Dim ver As String
   Dim servername As String
   Dim domainname As String
   Dim passwordm As String
   Dim GetLDAP As String
   Dim BaseDN As String
   Dim homedir As String
   Dim userid1 As String
   Dim userid2 As String
   Dim userid3 As String
   Dim userid4 As String
   Dim givenname1 As String
   Dim givenname2 As String
   Dim givenname3 As String
   Dim givenname4 As String
   Dim surname1 As String
   Dim surname2 As String
   Dim surname3 As String
   Dim surname4 As String
   Dim password1 As String
   Dim password2 As String
   Dim password3 As String
   Dim password4 As String
   Dim CType As String
   Dim Org1 As String
   Dim Org2 As String
   Dim Org3 As String
   Dim Org4 As String
   Dim OrgUnit1 As String
   Dim OrgUnit2 As String
   Dim OrgUnit3 As String
   Dim OrgUnit4 As String
   Dim OrgUnit11 As String
   Dim OrgUnit22 As String
   Dim OrgUnit33 As String
   Dim OrgUnit44 As String
   Dim OrgUnit111 As String
   Dim OrgUnit222 As String
   Dim OrgUnit333 As String
   Dim OrgUnit444 As String
   Dim CCont As String
   Dim Org As String
   Dim OrgU As String
   Dim OrgU1 As String
   Dim OrgU2 As String
   Dim OrgU3 As String
   Dim OrgU4 As String
   Dim OrgU5 As String
   Dim OrgU6 As String
   Dim OrgU7 As String
   Dim OrgU8 As String
   Dim OrgU9 As String
   Dim OrgU10 As String
   Dim OrgU11 As String
   Dim OrgU12 As String
   Dim OrgU13 As String
   Dim OrgU14 As String
   Dim OrgU15 As String
   Dim OrgU16 As String
   Dim OrgU17 As String
   Dim OrgU18 As String
   Dim OrgU19 As String
   Dim OrgU20 As String
   Dim OrgU21 As String
   Dim OrgU22 As String
   Dim OrgU23 As String
   Dim OrgU24 As String
   Dim OrgU25 As String
   Dim OrgU26 As String
   Dim OrgU27 As String
   Dim OrgU28 As String
   Dim OrgU29 As String
   Dim OrgU30 As String
   Dim OrgU31 As String
   Dim OrgU32 As String
   Dim OrgU33 As String
   Dim OrgU34 As String
   Dim OrgU35 As String
   Dim OrgU36 As String
   Dim RetVal As Long
   Dim UHomeDir As String
   Dim UHomeFile As String
   Dim CustCont As String
   Dim CustLDIF As String
   Dim MyPath
   Dim WPath
   Dim hConsole As Long
      
   RICEBatch = Text5.Text
   FileOut = Text6.Text
   filein = Text7.Text
   servername = Text8.Text
   domainname = Text9.Text
   beginval = 1
   endval = Val(Combo2.Text)
   Port = Combo1.Text
   passwordm = Combo14.Text
   ver = Combo6.Text
   WPath = Text19.Text
   homedir = Text401.Text
   MyPath = Text403.Text
   UHomeDir = Text404.Text
   UHomeFile = Text405.Text
   userid1 = Text10.Text
   userid2 = Text15.Text
   userid3 = Text20.Text
   userid4 = Text25.Text
   givenname1 = Text11.Text
   givenname2 = Text16.Text
   givenname3 = Text21.Text
   givenname4 = Text26.Text
   surname1 = Text12.Text
   surname2 = Text17.Text
   surname3 = Text22.Text
   surname4 = Text27.Text
   password1 = Text13.Text
   password2 = Text18.Text
   password3 = Text23.Text
   password4 = Text28.Text
   Org1 = Text103.Text
   Org2 = Text107.Text
   Org3 = Text111.Text
   Org4 = Text115.Text
   OrgUnit1 = Text102.Text
   OrgUnit2 = Text106.Text
   OrgUnit3 = Text110.Text
   OrgUnit4 = Text114.Text
   OrgUnit11 = Text101.Text
   OrgUnit22 = Text105.Text
   OrgUnit33 = Text109.Text
   OrgUnit44 = Text113.Text
   OrgUnit111 = Text100.Text
   OrgUnit222 = Text104.Text
   OrgUnit333 = Text108.Text
   OrgUnit444 = Text112.Text
   CCont = Combo199.Text
   Org = Text200.Text
   OrgU1 = Text1101.Text
   OrgU2 = Text1201.Text
   OrgU3 = Text1301.Text
   OrgU4 = Text1401.Text
   OrgU5 = Text1501.Text
   OrgU6 = Text1601.Text
   OrgU7 = Text1102.Text
   OrgU8 = Text1202.Text
   OrgU9 = Text1302.Text
   OrgU10 = Text1402.Text
   OrgU11 = Text1502.Text
   OrgU12 = Text1602.Text
   OrgU13 = Text1103.Text
   OrgU14 = Text1203.Text
   OrgU15 = Text1303.Text
   OrgU16 = Text1403.Text
   OrgU17 = Text1503.Text
   OrgU18 = Text1603.Text
   OrgU19 = Combo104.Text
   OrgU20 = Combo204.Text
   OrgU21 = Combo304.Text
   OrgU22 = Combo404.Text
   OrgU23 = Combo504.Text
   OrgU24 = Combo604.Text
   OrgU25 = Combo105.Text
   OrgU26 = Combo205.Text
   OrgU27 = Combo305.Text
   OrgU28 = Combo405.Text
   OrgU29 = Combo505.Text
   OrgU30 = Combo605.Text
   OrgU31 = Combo106.Text
   OrgU32 = Combo206.Text
   OrgU33 = Combo306.Text
   OrgU34 = Combo406.Text
   OrgU35 = Combo506.Text
   OrgU36 = Combo606.Text
   CustCont = Text29.Text
   CustLDIF = Text30.Text
   
   On Error GoTo ErrorHandler '*** Start up the error handler
   
   If CheckAdd = 1 Then CType = "add"
   If CheckDel = 1 Then CType = "delete"
                       
           Dim fso, Msg
           Set fso = CreateObject("Scripting.FileSystemObject")
           If (fso.FolderExists(WPath)) Then GoTo CStep180 Else MkDir WPath  'Make new directory or folder.
CStep180:
          ChDrive WPath 'Changes the current drive.
          ChDir WPath 'Changes the current directory or folder.
                              
        If RetrieveTreeCheck = 1 Then GoTo Step2

If CustomCheck = 1 Then GoTo CustLDIFStep1 'If Custom LDIF file is selected bypass the file creation.
                 
   '********************Start Writting LDIF Files
   
   MyVar = MsgBox("Files are being written", 0, "Writting Files.")
      
   Open FileOut For Output As #1 '***File Open***
   
      Print #1, "#This file generated by Novell's Tree Builder Version 3.3 (Written by: Robert Foster)" 'File Header
      Print #1, "version: 1"
      If CheckDel = 0 Then Print #1,
   
If SkipTreeCreateCheck = 0 Then GoTo BypassTree

'***Need to add code to allow numbers to start at something other than zero at some point***

   If endval = "1" Then GoTo Step4 'If endval is 1 this goes around the Progress Bar Error
   '***ProgressBar1.Min = beginval
   '***ProgressBar1.Max = endval
   '***ProgressBar1.Value = ProgressBar1.Min
   '***ProgressBar1.Visible = False
         
Step4:
   
If CType = "Delete" Then GoTo Step41

'Start Add Tree Information

      If CCont = "" Then GoTo Step22
      If CType = "delete" Then GoTo Step22

      Print #1, "dn: c=" + CCont
      Print #1, "changetype: " + CType
      Print #1, "objectClass: top"
      Print #1, "objectClass: country"
      If ver = "NDS 8" Then Print #1, "c: " + CCont
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,

Step22:

If CheckDel = 1 Then GoTo BypassTreeAdd

      If Not CCont = "" Then Print #1, "dn: o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "o: " + Org
      Print #1, "objectClass: organization"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU1
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU2
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU3
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU4
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
   
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU5
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
   
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU6
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
            
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU7
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU8
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU9
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU10
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
            
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU11
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
            
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU12
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU13
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU14
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU15
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU16
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU17
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU18
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU19
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU20
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU21
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU22
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU23
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU24
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU25
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU26
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU27
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU28
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU29
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU30
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU31 + ",ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU31 + ",ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU31
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU32 + ",ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU32 + ",ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU32
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU33 + ",ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU33 + ",ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU33
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU34 + ",ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU34 + ",ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU34
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU35 + ",ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU35 + ",ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU35
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU36 + ",ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU36 + ",ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU36
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      'Print #1,
      
'End Add Tree Information

BypassTreeAdd:
BypassTree:
BypassTree1:
   
   For i = beginval To endval
      '***ProgressBar1.Visible = True
      '***ProgressBar1.Value = ProgressBar1.Max
   
      'ProgressBar1.Value = i   '*****************************
      
      'Start User data
      If UserSetOneCheck = 0 Then GoTo Step10 'If Create User(s) is not checked, bypass user creation for that set
      Print #1,
      If AppDomCheck1 = 1 And CustContCheck = 1 Then Print #1, "dn: cn=" + userid1 + Format(i) + "@" + domainname + CustCont
      
      If AppDomCheck1 = 0 And CustContCheck = 1 Then Print #1, "dn: cn=" + userid1 + Format(i) + CustCont
      If CustContCheck = 1 Then GoTo CCStep3
     
      If Not CCont = "" And AppDomCheck1 = 1 And CustContCheck = 1 Then Print #1, "dn: cn=" + userid1 + Format(i) + "@" + domainname + ",ou=" + OrgUnit111 + ",ou=" + OrgUnit11 + ",ou=" + OrgUnit1 + ",o=" + Org1 + ",c=" + CCont
      If CCont = "" And AppDomCheck1 = 0 And CustContCheck = 0 Then Print #1, "dn: cn=" + userid1 + Format(i) + ",ou=" + OrgUnit111 + ",ou=" + OrgUnit11 + ",ou=" + OrgUnit1 + ",o=" + Org1
CCStep3:
      Print #1, "changetype: " + CType
      If CType = "delete" Then GoTo Step10
      If ver = "NDS 7" Then Print #1, "objectclass: top"
      If ver = "NDS 7" Then Print #1, "objectclass: person"
      If ver = "NDS 7" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 7" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 7" Then Print #1, "mail: " + userid1 + Format(i) + "@" + domainname
      If ver = "NDS 7" Then Print #1, "givenName: " + givenname1 + Format(i)
      If ver = "NDS 7" Then Print #1, "sn: " + surname1 + Format(i)
      If ver = "NDS 8" Then Print #1, "mail: " + userid1 + Format(i) + "@" + domainname
      Print #1, "uid: " + userid1 + Format(i)
      If ver = "NDS 8" Then Print #1, "givenName: " + givenname1 + Format(i)
      If ver = "NDS 8" Then Print #1, "sn: " + surname1 + Format(i)
      If ver = "NDS 8" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: person"
      If ver = "NDS 8" Then Print #1, "objectclass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectclass: top"
      If NoPwdChk1 = 1 Then GoTo NoPwd1
      If passwordm = "Yes" Then Print #1, "userpassword: " + userid1 + Format(i) Else Print #1, "userpassword: " + password1
NoPwd1:
      If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step10
      If ver = "NDS 8" Then Print #1, "ndsHomeDirectory: " + homedir + "\" + userid1 + Format(i)
      If ver = "NDS 7" Then Print #1, "homeDirectory: " + homedir + "\" + userid1 + Format(i)
           
Step10:

      If UserSetTwoCheck = 0 Then GoTo Step11 'If Create User(s) is not checked, bypass user creation for that set
      Print #1,
      If Not CCont = "" Then Print #1, "dn: cn=" + userid2 + Format(i) + ",ou=" + OrgUnit222 + ",ou=" + OrgUnit22 + ",ou=" + OrgUnit2 + ",o=" + Org2 + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: cn=" + userid2 + Format(i) + ",ou=" + OrgUnit222 + ",ou=" + OrgUnit22 + ",ou=" + OrgUnit2 + ",o=" + Org2
      Print #1, "changetype: " + CType
      If CType = "delete" Then GoTo Step11
      If ver = "NDS 7" Then Print #1, "objectclass: top"
      If ver = "NDS 7" Then Print #1, "objectclass: person"
      If ver = "NDS 7" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 7" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 7" Then Print #1, "mail: " + userid2 + Format(i) + "@" + domainname
      If ver = "NDS 7" Then Print #1, "givenName: " + givenname2 + Format(i)
      If ver = "NDS 7" Then Print #1, "sn: " + surname2 + Format(i)
      If ver = "NDS 8" Then Print #1, "mail: " + userid2 + Format(i) + "@" + domainname
      Print #1, "uid: " + userid2 + Format(i)
      If ver = "NDS 8" Then Print #1, "givenName: " + givenname2 + Format(i)
      If ver = "NDS 8" Then Print #1, "sn: " + surname2 + Format(i)
      If ver = "NDS 8" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: person"
      If ver = "NDS 8" Then Print #1, "objectclass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectclass: top"
      If NoPwdChk1 = 1 Then GoTo NoPwd2
      If passwordm = "Yes" Then Print #1, "userpassword: " + userid1 + Format(i) Else Print #1, "userpassword: " + password2
NoPwd2:
      If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step11
      If ver = "NDS 8" Then Print #1, "ndsHomeDirectory: " + homedir + "\" + userid2 + Format(i)
      If ver = "NDS 7" Then Print #1, "homeDirectory: " + homedir + "\" + userid2 + Format(i)
            
Step11:
      
      If UserSetThreeCheck = 0 Then GoTo Step12 'If Create User(s) is not checked, bypass user creation for that set
      Print #1,
      If Not CCont = "" Then Print #1, "dn: cn=" + userid3 + Format(i) + ",ou=" + OrgUnit333 + ",ou=" + OrgUnit33 + ",ou=" + OrgUnit3 + ",o=" + Org3 + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: cn=" + userid3 + Format(i) + ",ou=" + OrgUnit333 + ",ou=" + OrgUnit33 + ",ou=" + OrgUnit3 + ",o=" + Org3
      Print #1, "changetype: " + CType
      If CType = "delete" Then GoTo Step12
      If ver = "NDS 7" Then Print #1, "objectclass: top"
      If ver = "NDS 7" Then Print #1, "objectclass: person"
      If ver = "NDS 7" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 7" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 7" Then Print #1, "mail: " + userid3 + Format(i) + "@" + domainname
      If ver = "NDS 7" Then Print #1, "givenName: " + givenname3 + Format(i)
      If ver = "NDS 7" Then Print #1, "sn: " + surname3 + Format(i)
      If ver = "NDS 8" Then Print #1, "mail: " + userid3 + Format(i) + "@" + domainname
      Print #1, "uid: " + userid3 + Format(i)
      If ver = "NDS 8" Then Print #1, "givenName: " + givenname3 + Format(i)
      If ver = "NDS 8" Then Print #1, "sn: " + surname3 + Format(i)
      If ver = "NDS 8" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: person"
      If ver = "NDS 8" Then Print #1, "objectclass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectclass: top"
      If NoPwdChk1 = 1 Then GoTo NoPwd3
      If passwordm = "Yes" Then Print #1, "userpassword: " + userid3 + Format(i) Else Print #1, "userpassword: " + password3
NoPwd3:
      If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step12
      If ver = "NDS 8" Then Print #1, "ndsHomeDirectory: " + homedir + "\" + userid3 + Format(i)
      If ver = "NDS 7" Then Print #1, "homeDirectory: " + homedir + "\" + userid3 + Format(i)
            
Step12:
            
      If UserSetFourCheck = 0 Then GoTo Step13 'If Create User(s) is not checked, bypass user creation for that set
      Print #1,
      If Not CCont = "" Then Print #1, "dn: cn=" + userid4 + Format(i) + ",ou=" + OrgUnit444 + ",ou=" + OrgUnit44 + ",ou=" + OrgUnit4 + ",o=" + Org4 + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: cn=" + userid4 + Format(i) + ",ou=" + OrgUnit444 + ",ou=" + OrgUnit44 + ",ou=" + OrgUnit4 + ",o=" + Org4
      Print #1, "changetype: " + CType
      If CType = "delete" Then GoTo Step13
      If ver = "NDS 7" Then Print #1, "objectclass: top"
      If ver = "NDS 7" Then Print #1, "objectclass: person"
      If ver = "NDS 7" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 7" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 7" Then Print #1, "mail: " + userid4 + Format(i) + "@" + domainname
      If ver = "NDS 7" Then Print #1, "givenName: " + givenname4 + Format(i)
      If ver = "NDS 7" Then Print #1, "sn: " + surname4 + Format(i)
      If ver = "NDS 8" Then Print #1, "mail: " + userid4 + Format(i) + "@" + domainname
      Print #1, "uid: " + userid4 + Format(i)
      If ver = "NDS 8" Then Print #1, "givenName: " + givenname4 + Format(i)
      If ver = "NDS 8" Then Print #1, "sn: " + surname4 + Format(i)
      If ver = "NDS 8" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: person"
      If ver = "NDS 8" Then Print #1, "objectclass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectclass: top"
      If NoPwdChk1 = 1 Then GoTo NoPwd4
      If passwordm = "Yes" Then Print #1, "userpassword: " + userid4 + Format(i) Else Print #1, "userpassword: " + password4
NoPwd4:
      If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step13
      If ver = "NDS 8" Then Print #1, "ndsHomeDirectory: " + homedir + "\" + userid4 + Format(i)
      If ver = "NDS 7" Then Print #1, "homeDirectory: " + homedir + "\" + userid4 + Format(i)
      'End User Data
      
Step13:
      '***ProgressBar1.Visible = True
      
   Next i
      
'Start Delete Tree Information
If SkipTreeCreateCheck = "0" Then GoTo BypassTree2
Step41:

   If CheckAdd = 1 Then GoTo ByPassDel

      If CheckDel = 1 Then Print #1,
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU36 + ",ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU36 + ",ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU35 + ",ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU35 + ",ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
            
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU34 + ",ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU34 + ",ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
    
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU33 + ",ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU33 + ",ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU32 + ",ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU32 + ",ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU31 + ",ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU31 + ",ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: o=" + Org
      Print #1, "changetype: delete"
      Print #1,
            
If CCont = "" Then GoTo ByPassDel

      Print #1, "dn: c=" + CCont
      Print #1, "changetype: delete"
      Print #1,

ByPassDel:
BypassTree2:

'End Delete Tree Information
   
   Close #1
   
   MyVar = MsgBox("Completed writing LDIF file.", 0, "Completed!")
   
Step2:
CustLDIFStep1:

'Start ice Batch
Dim Sice As String
Dim Source_Sw As String
Dim Destination_Sw As String
Dim LDIF_Sw As String
Dim LDAP_Sw As String
Dim IP_Sw As String
Dim IP As String
Dim Prt_Sw As String
Dim Prt As String
Dim Uname_Sw As String
Dim Uname As String
Dim Pwd_Sw As String
Dim Pwd As String
Dim BDN_Sw As String
Dim BDN As String
Dim Srch_Sw As String
Dim Srch As String
Dim RtCrt_Sw As String
Dim RtCrt As String
Dim StopOnErr As String
Dim F_Sw As String
Dim FOut As String
Dim FIn As String
Dim CFile As String
Dim Sp As String

Sice = "ice" + " "
Source_Sw = "-S" + " "
Destination_Sw = "-D" + " "
LDIF_Sw = "LDIF" + " "
LDAP_Sw = "LDAP" + " "
IP_Sw = "-s" + " "
IP = Text1.Text + " "
Prt_Sw = "-p" + " "
Prt = Combo1.Text + " "
Uname_Sw = "-d" + " "
Uname = Text2.Text + " "
Pwd_Sw = "-w" + " "
Pwd = Text3.Text + " "
BDN_Sw = "-b" + " "
BDN = Text14.Text + " "
Srch_Sw = "-c" + " "
Srch = Text31.Text + " "
RtCrt_Sw = "-L" + " "
RtCrt = Text4.Text + " "
F_Sw = "-f" + " "
FOut = Text6.Text + " "
FIn = Text7.Text + " "
StopOnErr = "-c" + " "
CFile = Text30.Text + " "
Sp = " "

If IP = "" + " " Then   ' IP = ""
      MyVar = MsgBox("Please specify an IPAddress.", 0, "Specify IP Address") ' Perform some action.
      If MyVar = vbOK Then GoTo Step161
End If

If Prt = "" + " " Then   ' Prt = ""
      MyVar = MsgBox("Please specify a Port.", 0, "Specify Port") ' Perform some action.
      If MyVar = vbOK Then GoTo Step161
End If

If Uname = " " Then Uname_Sw = ""
If Uname = " " Then Uname = ""
If Pwd = " " Then Pwd_Sw = ""
If Pwd = " " Then Pwd = ""
If BDN = " " Then BDN_Sw = ""
If BDN = " " Then BDN = ""
If Srch = " " Then Srch_Sw = ""
If Srch = " " Then Srch = ""
If RtCrt = " " Then RtCrt_Sw = ""
If RtCrt = " " Then RtCrt = ""
If RtCrt = " " Then RtCrt_Sw = ""
If RtCrt = " " Then RtCrt = ""
If CustomCheck = 1 Then FOut = CFile

      Open RICEBatch For Output As #2
      Print #2, "path %PATH%;" + App.Path
      Print #2, "del ice.Log"
      If RetrieveTreeCheck = 1 Then GoTo Chk2Rtv:

'Send LDAP
If StopOnErrCheck = 0 Then Print #2, Sice + Source_Sw + LDIF_Sw + F_Sw + FOut + StopOnErr + Destination_Sw + LDAP_Sw + IP_Sw + IP + Prt_Sw + Prt + Uname_Sw + Uname + Pwd_Sw + Pwd + RtCrt_Sw + RtCrt
If StopOnErrCheck = 1 Then Print #2, Sice + Source_Sw + LDIF_Sw + F_Sw + FOut + Destination_Sw + LDAP_Sw + IP_Sw + IP + Prt_Sw + Prt + Uname_Sw + Uname + Pwd_Sw + Pwd + RtCrt_Sw + RtCrt

Chk2Rtv:
'Get LDAP
If RetrieveTreeCheck = 1 Then Print #2, Sice + Source_Sw + LDAP_Sw + IP_Sw + IP + Prt_Sw + Prt + Uname_Sw + Uname + Pwd_Sw + Pwd + BDN_Sw + BDN + Srch_Sw + Srch + RtCrt_Sw + RtCrt + Destination_Sw + LDIF_Sw + F_Sw + FIn

   Close #2
'End ice Batch

'Start Display Page
 ICE.Show 0
 
   Dim JobToDo As String
      JobToDo = RICEBatch
      DoEvents: Sleep 100
      Shell32Bit JobToDo
'End Display Page

'Start User Home Directory Creation Section

'***Put this back when logical ***MyVar = MsgBox("Creating Directories. When they have been written, a dialog will appear to tell you that it is complete.", 0, "Creating User Home Directories")

   Dim beginval1 As Long
   Dim endval1 As Long
   
   beginval1 = 1
   endval1 = Val(Combo2.Text)
   
If UserHomeCheck = 0 Then GoTo Step161
If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step161
          If (fso.FolderExists(MyPath)) Then GoTo Step1000 Else MkDir MyPath 'Make new directory or folder.
Step1000:
          ChDrive MyPath
          ChDir MyPath 'Changes the current directory or folder.
If endval = "1" Then GoTo Step150
      '***ProgressBar1.Min = beginval1
      '***ProgressBar1.Max = endval1
      '***ProgressBar1.Value = ProgressBar1.Min
      '***ProgressBar1.Visible = False

Step150:
      For j = beginval1 To endval1
         '***ProgressBar1.Value = j
   If userid1 = "" Then GoTo Step151
   If UserSetOneCheck = 0 Then GoTo Step151
      If (fso.FolderExists(MyPath + userid1 + Format(j))) Then GoTo CStep1 Else MkDir MyPath + userid1 + Format(j)  'Make new directory or folder.
CStep1:
      ChDir MyPath + userid1 + Format(j)
      If (fso.FolderExists(UHomeDir)) Then GoTo CStep2 Else MkDir UHomeDir  'Make new directory or folder.
CStep2:
      ChDir UHomeDir
      Open UHomeFile For Output As #2
      Print #2, userid1 + Format(j)
      ChDir "cd ..\.."
      Close #2
            
Step151:
   If userid2 = "" Then GoTo Step152
   If UserSetTwoCheck = 0 Then GoTo Step152
      If (fso.FolderExists(MyPath + userid2 + Format(j))) Then GoTo CStep3 Else MkDir MyPath + userid2 + Format(j) 'Make new directory or folder.
CStep3:
      ChDir MyPath + userid2 + Format(j)
      If (fso.FolderExists(UHomeDir)) Then GoTo CStep4 Else MkDir UHomeDir  'Make new directory or folder.
CStep4:
      ChDir UHomeDir
      Open UHomeFile For Output As #2
      Print #2, userid2 + Format(j)
      ChDir "cd ..\.."
      Close #2
         
Step152:
   If userid3 = "" Then GoTo Step153
   If UserSetThreeCheck = 0 Then GoTo Step153
      If (fso.FolderExists(MyPath + userid3 + Format(j))) Then GoTo CStep5 Else MkDir MyPath + userid3 + Format(j)  'Make new directory or folder.
CStep5:
      ChDir MyPath + userid3 + Format(j)
      If (fso.FolderExists(UHomeDir)) Then GoTo CStep6 Else MkDir UHomeDir  'Make new directory or folder.
CStep6:
      ChDir UHomeDir
      Open UHomeFile For Output As #2
      Print #2, userid3 + Format(j)
      ChDir "cd ..\.."
      Close #2
      
Step153:
   If userid4 = "" Then GoTo Step154
   If UserSetFourCheck = 0 Then GoTo Step154
      If (fso.FolderExists(MyPath + userid4 + Format(j))) Then GoTo CStep7 Else MkDir MyPath + userid4 + Format(j)  'Make new directory or folder.
CStep7:
      ChDir MyPath + userid4 + Format(j)
      If (fso.FolderExists(UHomeDir)) Then GoTo CStep8 Else MkDir UHomeDir  'Make new directory or folder.
CStep8:
      ChDir UHomeDir
      Open UHomeFile For Output As #2
      Print #2, userid4 + Format(j)
      ChDir "cd ..\.."
      Close #2
      
Step154:
      
If endval = "1" Then GoTo Step160
'***ProgressBar1.Visible = True
   Next j
      ChDir WPath
               
Step160:

     ChDrive "C:"
     ChDir App.Path
     
     MyVar = MsgBox("Directories have all been created.", 0, "Complete!")

Step161:

'End User Home Directory Creation Section
'***ProgressBar1.Visible = True
'***ProgressBar1.Value = ProgressBar1.Max

'This is the error handler
On Error GoTo ErrorResume   'Resume next in case file is locked
ErrorResume:
Resume Next   'in case file is locked
ErrorHandler:
If Err.Description = "" Then Resume Next Else MsgBox Err.Description
End Sub

Private Sub CmdWrite_Click()
   
   Dim RICEBatch As String
   Dim FileOut As String
   Dim filein As String
   Dim beginval As Long
   Dim endval As Long
   Dim ver As String
   Dim servername As String
   Dim domainname As String
   Dim passwordm As String
   Dim GetLDAP As String
   Dim BaseDN As String
   Dim homedir As String
   Dim userid1 As String
   Dim userid2 As String
   Dim userid3 As String
   Dim userid4 As String
   Dim givenname1 As String
   Dim givenname2 As String
   Dim givenname3 As String
   Dim givenname4 As String
   Dim surname1 As String
   Dim surname2 As String
   Dim surname3 As String
   Dim surname4 As String
   Dim password1 As String
   Dim password2 As String
   Dim password3 As String
   Dim password4 As String
   Dim CType As String
   Dim Org1 As String
   Dim Org2 As String
   Dim Org3 As String
   Dim Org4 As String
   Dim OrgUnit1 As String
   Dim OrgUnit2 As String
   Dim OrgUnit3 As String
   Dim OrgUnit4 As String
   Dim OrgUnit11 As String
   Dim OrgUnit22 As String
   Dim OrgUnit33 As String
   Dim OrgUnit44 As String
   Dim OrgUnit111 As String
   Dim OrgUnit222 As String
   Dim OrgUnit333 As String
   Dim OrgUnit444 As String
   Dim CCont As String
   Dim Org As String
   Dim OrgU As String
   Dim OrgU1 As String
   Dim OrgU2 As String
   Dim OrgU3 As String
   Dim OrgU4 As String
   Dim OrgU5 As String
   Dim OrgU6 As String
   Dim OrgU7 As String
   Dim OrgU8 As String
   Dim OrgU9 As String
   Dim OrgU10 As String
   Dim OrgU11 As String
   Dim OrgU12 As String
   Dim OrgU13 As String
   Dim OrgU14 As String
   Dim OrgU15 As String
   Dim OrgU16 As String
   Dim OrgU17 As String
   Dim OrgU18 As String
   Dim OrgU19 As String
   Dim OrgU20 As String
   Dim OrgU21 As String
   Dim OrgU22 As String
   Dim OrgU23 As String
   Dim OrgU24 As String
   Dim OrgU25 As String
   Dim OrgU26 As String
   Dim OrgU27 As String
   Dim OrgU28 As String
   Dim OrgU29 As String
   Dim OrgU30 As String
   Dim OrgU31 As String
   Dim OrgU32 As String
   Dim OrgU33 As String
   Dim OrgU34 As String
   Dim OrgU35 As String
   Dim OrgU36 As String
   Dim RetVal As Long
   Dim UHomeDir As String
   Dim UHomeFile As String
   Dim CustCont As String
   Dim CustLDIF As String
   Dim MyPath
   Dim WPath
   Dim hConsole As Long
      
   RICEBatch = Text5.Text
   FileOut = Text6.Text
   filein = Text7.Text
   servername = Text8.Text
   domainname = Text9.Text
   beginval = 1
   endval = Val(Combo2.Text)
   Port = Combo1.Text
   passwordm = Combo14.Text
   ver = Combo6.Text
   WPath = Text19.Text
   homedir = Text401.Text
   MyPath = Text403.Text
   UHomeDir = Text404.Text
   UHomeFile = Text405.Text
   userid1 = Text10.Text
   userid2 = Text15.Text
   userid3 = Text20.Text
   userid4 = Text25.Text
   givenname1 = Text11.Text
   givenname2 = Text16.Text
   givenname3 = Text21.Text
   givenname4 = Text26.Text
   surname1 = Text12.Text
   surname2 = Text17.Text
   surname3 = Text22.Text
   surname4 = Text27.Text
   password1 = Text13.Text
   password2 = Text18.Text
   password3 = Text23.Text
   password4 = Text28.Text
   Org1 = Text103.Text
   Org2 = Text107.Text
   Org3 = Text111.Text
   Org4 = Text115.Text
   OrgUnit1 = Text102.Text
   OrgUnit2 = Text106.Text
   OrgUnit3 = Text110.Text
   OrgUnit4 = Text114.Text
   OrgUnit11 = Text101.Text
   OrgUnit22 = Text105.Text
   OrgUnit33 = Text109.Text
   OrgUnit44 = Text113.Text
   OrgUnit111 = Text100.Text
   OrgUnit222 = Text104.Text
   OrgUnit333 = Text108.Text
   OrgUnit444 = Text112.Text
   CCont = Combo199.Text
   Org = Text200.Text
   OrgU1 = Text1101.Text
   OrgU2 = Text1201.Text
   OrgU3 = Text1301.Text
   OrgU4 = Text1401.Text
   OrgU5 = Text1501.Text
   OrgU6 = Text1601.Text
   OrgU7 = Text1102.Text
   OrgU8 = Text1202.Text
   OrgU9 = Text1302.Text
   OrgU10 = Text1402.Text
   OrgU11 = Text1502.Text
   OrgU12 = Text1602.Text
   OrgU13 = Text1103.Text
   OrgU14 = Text1203.Text
   OrgU15 = Text1303.Text
   OrgU16 = Text1403.Text
   OrgU17 = Text1503.Text
   OrgU18 = Text1603.Text
   OrgU19 = Combo104.Text
   OrgU20 = Combo204.Text
   OrgU21 = Combo304.Text
   OrgU22 = Combo404.Text
   OrgU23 = Combo504.Text
   OrgU24 = Combo604.Text
   OrgU25 = Combo105.Text
   OrgU26 = Combo205.Text
   OrgU27 = Combo305.Text
   OrgU28 = Combo405.Text
   OrgU29 = Combo505.Text
   OrgU30 = Combo605.Text
   OrgU31 = Combo106.Text
   OrgU32 = Combo206.Text
   OrgU33 = Combo306.Text
   OrgU34 = Combo406.Text
   OrgU35 = Combo506.Text
   OrgU36 = Combo606.Text
   CustCont = Text29.Text
   CustLDIF = Text30.Text
   
   On Error GoTo ErrorHandler '*** Start up the error handler
   
   If CheckAdd = 1 Then CType = "add"
   If CheckDel = 1 Then CType = "delete"
                       
           Dim fso, Msg
           Set fso = CreateObject("Scripting.FileSystemObject")
           If (fso.FolderExists(WPath)) Then GoTo CStep180 Else MkDir WPath  'Make new directory or folder.
CStep180:
          ChDrive WPath 'Changes the current drive.
          ChDir WPath 'Changes the current directory or folder.
                              
        If RetrieveTreeCheck = 1 Then GoTo Step2

If CustomCheck = 1 Then GoTo CustLDIFStep1 'If Custom LDIF file is selected bypass the file creation.
                 
   '********************Start Writting LDIF Files
   
   MyVar = MsgBox("Files are being written", 0, "Writting Files.")
      
   Open FileOut For Output As #1 '***File Open***
   
      Print #1, "#This file generated by Novell's Tree Builder Version 3.3 (Written by: Robert Foster)" 'File Header
      Print #1, "version: 1"
      If CheckDel = 0 Then Print #1,
   
If SkipTreeCreateCheck = 0 Then GoTo BypassTree

'***Need to add code to allow numbers to start at something other than zero at some point***

   If endval = "1" Then GoTo Step4 'If endval is 1 this goes around the Progress Bar Error
   '***ProgressBar1.Min = beginval
   '***ProgressBar1.Max = endval
   '***ProgressBar1.Value = ProgressBar1.Min
   '***ProgressBar1.Visible = False
         
Step4:
   
If CType = "Delete" Then GoTo Step41

'Start Add Tree Information

      If CCont = "" Then GoTo Step22
      If CType = "delete" Then GoTo Step22

      Print #1, "dn: c=" + CCont
      Print #1, "changetype: " + CType
      Print #1, "objectClass: top"
      Print #1, "objectClass: country"
      If ver = "NDS 8" Then Print #1, "c: " + CCont
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,

Step22:

If CheckDel = 1 Then GoTo BypassTreeAdd

      If Not CCont = "" Then Print #1, "dn: o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "o: " + Org
      Print #1, "objectClass: organization"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU1
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU2
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU3
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU4
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
   
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU5
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
   
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU6
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
            
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU7
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU8
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU9
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU10
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
            
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU11
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
            
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU12
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU13
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU14
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU15
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU16
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU17
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU18
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU19
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU20
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU21
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU22
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU23
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU24
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU25
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU26
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU27
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU28
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU29
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU30
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU31 + ",ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU31 + ",ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU31
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU32 + ",ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU32 + ",ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU32
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU33 + ",ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU33 + ",ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU33
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU34 + ",ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU34 + ",ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU34
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU35 + ",ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU35 + ",ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU35
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU36 + ",ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU36 + ",ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: " + CType
      If ver = "NDS 7" Then Print #1, "objectClass: top"
      If ver = "NDS 8" Then Print #1, "ou: " + OrgU36
      Print #1, "objectClass: organizationalUnit"
      If ver = "NDS 8" Then Print #1, "objectClass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectClass: top"
      'Print #1,
      
'End Add Tree Information

BypassTreeAdd:
BypassTree:
BypassTree1:
   
   For i = beginval To endval
      '***ProgressBar1.Visible = True
      '***ProgressBar1.Value = ProgressBar1.Max
   
      'ProgressBar1.Value = i   '*****************************
      
      'Start User data
      If UserSetOneCheck = 0 Then GoTo Step10 'If Create User(s) is not checked, bypass user creation for that set
      Print #1,
      If AppDomCheck1 = 1 And CustContCheck = 1 Then Print #1, "dn: cn=" + userid1 + Format(i) + "@" + domainname + CustCont
      
      If AppDomCheck1 = 0 And CustContCheck = 1 Then Print #1, "dn: cn=" + userid1 + Format(i) + CustCont
      If CustContCheck = 1 Then GoTo CCStep3
     
      If Not CCont = "" And AppDomCheck1 = 1 And CustContCheck = 1 Then Print #1, "dn: cn=" + userid1 + Format(i) + "@" + domainname + ",ou=" + OrgUnit111 + ",ou=" + OrgUnit11 + ",ou=" + OrgUnit1 + ",o=" + Org1 + ",c=" + CCont
      If CCont = "" And AppDomCheck1 = 0 And CustContCheck = 0 Then Print #1, "dn: cn=" + userid1 + Format(i) + ",ou=" + OrgUnit111 + ",ou=" + OrgUnit11 + ",ou=" + OrgUnit1 + ",o=" + Org1
CCStep3:
      Print #1, "changetype: " + CType
      If CType = "delete" Then GoTo Step10
      If ver = "NDS 7" Then Print #1, "objectclass: top"
      If ver = "NDS 7" Then Print #1, "objectclass: person"
      If ver = "NDS 7" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 7" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 7" Then Print #1, "mail: " + userid1 + Format(i) + "@" + domainname
      If ver = "NDS 7" Then Print #1, "givenName: " + givenname1 + Format(i)
      If ver = "NDS 7" Then Print #1, "sn: " + surname1 + Format(i)
      If ver = "NDS 8" Then Print #1, "mail: " + userid1 + Format(i) + "@" + domainname
      Print #1, "uid: " + userid1 + Format(i)
      If ver = "NDS 8" Then Print #1, "givenName: " + givenname1 + Format(i)
      If ver = "NDS 8" Then Print #1, "sn: " + surname1 + Format(i)
      If ver = "NDS 8" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: person"
      If ver = "NDS 8" Then Print #1, "objectclass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectclass: top"
      If NoPwdChk1 = 1 Then GoTo NoPwd1
      If passwordm = "Yes" Then Print #1, "userpassword: " + userid1 + Format(i) Else Print #1, "userpassword: " + password1
NoPwd1:
      If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step10
      If ver = "NDS 8" Then Print #1, "ndsHomeDirectory: " + homedir + "\" + userid1 + Format(i)
      If ver = "NDS 7" Then Print #1, "homeDirectory: " + homedir + "\" + userid1 + Format(i)
           
Step10:

      If UserSetTwoCheck = 0 Then GoTo Step11 'If Create User(s) is not checked, bypass user creation for that set
      Print #1,
      If Not CCont = "" Then Print #1, "dn: cn=" + userid2 + Format(i) + ",ou=" + OrgUnit222 + ",ou=" + OrgUnit22 + ",ou=" + OrgUnit2 + ",o=" + Org2 + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: cn=" + userid2 + Format(i) + ",ou=" + OrgUnit222 + ",ou=" + OrgUnit22 + ",ou=" + OrgUnit2 + ",o=" + Org2
      Print #1, "changetype: " + CType
      If CType = "delete" Then GoTo Step11
      If ver = "NDS 7" Then Print #1, "objectclass: top"
      If ver = "NDS 7" Then Print #1, "objectclass: person"
      If ver = "NDS 7" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 7" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 7" Then Print #1, "mail: " + userid2 + Format(i) + "@" + domainname
      If ver = "NDS 7" Then Print #1, "givenName: " + givenname2 + Format(i)
      If ver = "NDS 7" Then Print #1, "sn: " + surname2 + Format(i)
      If ver = "NDS 8" Then Print #1, "mail: " + userid2 + Format(i) + "@" + domainname
      Print #1, "uid: " + userid2 + Format(i)
      If ver = "NDS 8" Then Print #1, "givenName: " + givenname2 + Format(i)
      If ver = "NDS 8" Then Print #1, "sn: " + surname2 + Format(i)
      If ver = "NDS 8" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: person"
      If ver = "NDS 8" Then Print #1, "objectclass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectclass: top"
      If NoPwdChk1 = 1 Then GoTo NoPwd2
      If passwordm = "Yes" Then Print #1, "userpassword: " + userid1 + Format(i) Else Print #1, "userpassword: " + password2
NoPwd2:
      If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step11
      If ver = "NDS 8" Then Print #1, "ndsHomeDirectory: " + homedir + "\" + userid2 + Format(i)
      If ver = "NDS 7" Then Print #1, "homeDirectory: " + homedir + "\" + userid2 + Format(i)
            
Step11:
      
      If UserSetThreeCheck = 0 Then GoTo Step12 'If Create User(s) is not checked, bypass user creation for that set
      Print #1,
      If Not CCont = "" Then Print #1, "dn: cn=" + userid3 + Format(i) + ",ou=" + OrgUnit333 + ",ou=" + OrgUnit33 + ",ou=" + OrgUnit3 + ",o=" + Org3 + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: cn=" + userid3 + Format(i) + ",ou=" + OrgUnit333 + ",ou=" + OrgUnit33 + ",ou=" + OrgUnit3 + ",o=" + Org3
      Print #1, "changetype: " + CType
      If CType = "delete" Then GoTo Step12
      If ver = "NDS 7" Then Print #1, "objectclass: top"
      If ver = "NDS 7" Then Print #1, "objectclass: person"
      If ver = "NDS 7" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 7" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 7" Then Print #1, "mail: " + userid3 + Format(i) + "@" + domainname
      If ver = "NDS 7" Then Print #1, "givenName: " + givenname3 + Format(i)
      If ver = "NDS 7" Then Print #1, "sn: " + surname3 + Format(i)
      If ver = "NDS 8" Then Print #1, "mail: " + userid3 + Format(i) + "@" + domainname
      Print #1, "uid: " + userid3 + Format(i)
      If ver = "NDS 8" Then Print #1, "givenName: " + givenname3 + Format(i)
      If ver = "NDS 8" Then Print #1, "sn: " + surname3 + Format(i)
      If ver = "NDS 8" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: person"
      If ver = "NDS 8" Then Print #1, "objectclass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectclass: top"
      If NoPwdChk1 = 1 Then GoTo NoPwd3
      If passwordm = "Yes" Then Print #1, "userpassword: " + userid3 + Format(i) Else Print #1, "userpassword: " + password3
NoPwd3:
      If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step12
      If ver = "NDS 8" Then Print #1, "ndsHomeDirectory: " + homedir + "\" + userid3 + Format(i)
      If ver = "NDS 7" Then Print #1, "homeDirectory: " + homedir + "\" + userid3 + Format(i)
            
Step12:
            
      If UserSetFourCheck = 0 Then GoTo Step13 'If Create User(s) is not checked, bypass user creation for that set
      Print #1,
      If Not CCont = "" Then Print #1, "dn: cn=" + userid4 + Format(i) + ",ou=" + OrgUnit444 + ",ou=" + OrgUnit44 + ",ou=" + OrgUnit4 + ",o=" + Org4 + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: cn=" + userid4 + Format(i) + ",ou=" + OrgUnit444 + ",ou=" + OrgUnit44 + ",ou=" + OrgUnit4 + ",o=" + Org4
      Print #1, "changetype: " + CType
      If CType = "delete" Then GoTo Step13
      If ver = "NDS 7" Then Print #1, "objectclass: top"
      If ver = "NDS 7" Then Print #1, "objectclass: person"
      If ver = "NDS 7" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 7" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 7" Then Print #1, "mail: " + userid4 + Format(i) + "@" + domainname
      If ver = "NDS 7" Then Print #1, "givenName: " + givenname4 + Format(i)
      If ver = "NDS 7" Then Print #1, "sn: " + surname4 + Format(i)
      If ver = "NDS 8" Then Print #1, "mail: " + userid4 + Format(i) + "@" + domainname
      Print #1, "uid: " + userid1 + Format(i)
      If ver = "NDS 8" Then Print #1, "givenName: " + givenname4 + Format(i)
      If ver = "NDS 8" Then Print #1, "sn: " + surname4 + Format(i)
      If ver = "NDS 8" Then Print #1, "objectclass: inetOrgPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: organizationalPerson"
      If ver = "NDS 8" Then Print #1, "objectclass: person"
      If ver = "NDS 8" Then Print #1, "objectclass: ndsLoginProperties"
      If ver = "NDS 8" Then Print #1, "objectclass: top"
      If NoPwdChk1 = 1 Then GoTo NoPwd4
      If passwordm = "Yes" Then Print #1, "userpassword: " + userid4 + Format(i) Else Print #1, "userpassword: " + password4
NoPwd4:
      If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step13
      If ver = "NDS 8" Then Print #1, "ndsHomeDirectory: " + homedir + "\" + userid4 + Format(i)
      If ver = "NDS 7" Then Print #1, "homeDirectory: " + homedir + "\" + userid4 + Format(i)
      'End User Data
      
Step13:
      '***ProgressBar1.Visible = True
      
   Next i
      
'Start Delete Tree Information
If SkipTreeCreateCheck = "0" Then GoTo BypassTree2
Step41:

   If CheckAdd = 1 Then GoTo ByPassDel

      If CheckDel = 1 Then Print #1,
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU36 + ",ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU36 + ",ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU35 + ",ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU35 + ",ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
            
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU34 + ",ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU34 + ",ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
    
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU33 + ",ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU33 + ",ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU32 + ",ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU32 + ",ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU31 + ",ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU31 + ",ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU30 + ",ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU29 + ",ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU28 + ",ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU27 + ",ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU26 + ",ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU25 + ",ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU24 + ",ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU23 + ",ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU22 + ",ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU21 + ",ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU20 + ",ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU19 + ",ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU18 + ",ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU17 + ",ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU16 + ",ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU15 + ",ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU14 + ",ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU13 + ",ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU12 + ",ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU11 + ",ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU10 + ",ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU9 + ",ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU8 + ",ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU7 + ",ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU6 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU6 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU5 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU5 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU4 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU4 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU3 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU3 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU2 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU2 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: ou=" + OrgU1 + ",o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: ou=" + OrgU1 + ",o=" + Org
      Print #1, "changetype: delete"
      Print #1,
      
      If Not CCont = "" Then Print #1, "dn: o=" + Org + ",c=" + CCont
      If CCont = "" Then Print #1, "dn: o=" + Org
      Print #1, "changetype: delete"
      Print #1,
            
If CCont = "" Then GoTo ByPassDel

      Print #1, "dn: c=" + CCont
      Print #1, "changetype: delete"
      Print #1,

ByPassDel:
BypassTree2:

'End Delete Tree Information
   
   Close #1
   
MyVar = MsgBox("Completed writing LDIF file.", 0, "Completed!")
   
Step2:
CustLDIFStep1:

'Start ice Batch
Dim Sice As String
Dim Source_Sw As String
Dim Destination_Sw As String
Dim LDIF_Sw As String
Dim LDAP_Sw As String
Dim IP_Sw As String
Dim IP As String
Dim Prt_Sw As String
Dim Prt As String
Dim Uname_Sw As String
Dim Uname As String
Dim Pwd_Sw As String
Dim Pwd As String
Dim BDN_Sw As String
Dim BDN As String
Dim Srch_Sw As String
Dim Srch As String
Dim RtCrt_Sw As String
Dim RtCrt As String
Dim StopOnErr As String
Dim F_Sw As String
Dim FOut As String
Dim FIn As String
Dim CFile As String
Dim Sp As String

Sice = "ice" + " "
Source_Sw = "-S" + " "
Destination_Sw = "-D" + " "
LDIF_Sw = "LDIF" + " "
LDAP_Sw = "LDAP" + " "
IP_Sw = "-s" + " "
IP = Text1.Text + " "
Prt_Sw = "-p" + " "
Prt = Combo1.Text + " "
Uname_Sw = "-d" + " "
Uname = Text2.Text + " "
Pwd_Sw = "-w" + " "
Pwd = Text3.Text + " "
BDN_Sw = "-b" + " "
BDN = Text14.Text + " "
Srch_Sw = "-c" + " "
Srch = Text31.Text + " "
RtCrt_Sw = "-L" + " "
RtCrt = Text4.Text + " "
F_Sw = "-f" + " "
FOut = Text6.Text + " "
FIn = Text7.Text + " "
StopOnErr = "-c" + " "
CFile = Text30.Text + " "
Sp = " "

If IP = "" + " " Then   ' IP = ""
      MyVar = MsgBox("Please specify an IPAddress.", 0, "Specify IP Address") ' Perform some action.
      If MyVar = vbOK Then GoTo Step161
End If

If Prt = "" + " " Then   ' Prt = ""
      MyVar = MsgBox("Please specify a Port.", 0, "Specify Port") ' Perform some action.
      If MyVar = vbOK Then GoTo Step161
End If

If Uname = " " Then Uname_Sw = ""
If Uname = " " Then Uname = ""
If Pwd = " " Then Pwd_Sw = ""
If Pwd = " " Then Pwd = ""
If BDN = " " Then BDN_Sw = ""
If BDN = " " Then BDN = ""
If Srch = " " Then Srch_Sw = ""
If Srch = " " Then Srch = ""
If RtCrt = " " Then RtCrt_Sw = ""
If RtCrt = " " Then RtCrt = ""
If RtCrt = " " Then RtCrt_Sw = ""
If RtCrt = " " Then RtCrt = ""
If CustomCheck = 1 Then FOut = CFile

      Open RICEBatch For Output As #2
      Print #2, "path %PATH%;" + App.Path
      Print #2, "del ice.Log"
      If RetrieveTreeCheck = 1 Then GoTo Chk2Rtv:

'Send LDAP
If StopOnErrCheck = 0 Then Print #2, Sice + Source_Sw + LDIF_Sw + F_Sw + FOut + StopOnErr + Destination_Sw + LDAP_Sw + IP_Sw + IP + Prt_Sw + Prt + Uname_Sw + Uname + Pwd_Sw + Pwd + RtCrt_Sw + RtCrt
If StopOnErrCheck = 1 Then Print #2, Sice + Source_Sw + LDIF_Sw + F_Sw + FOut + Destination_Sw + LDAP_Sw + IP_Sw + IP + Prt_Sw + Prt + Uname_Sw + Uname + Pwd_Sw + Pwd + RtCrt_Sw + RtCrt

Chk2Rtv:
'Get LDAP
If RetrieveTreeCheck = 1 Then Print #2, Sice + Source_Sw + LDAP_Sw + IP_Sw + IP + Prt_Sw + Prt + Uname_Sw + Uname + Pwd_Sw + Pwd + BDN_Sw + BDN + Srch_Sw + Srch + RtCrt_Sw + RtCrt + Destination_Sw + LDIF_Sw + F_Sw + FIn

   Close #2
'End ice Batch

'Start Display Page
 'ICE.Show 0
 
   'Dim JobToDo As String
   '   JobToDo = RICEBatch
   '   DoEvents: Sleep 100
   '   Shell32Bit JobToDo
'End Display Page

'Start User Home Directory Creation Section

'***Add Later when you know the logic***MyVar = MsgBox("Creating Directories. When they have been written, a dialog will appear to tell you that it is complete.", 0, "Creating User Home Directories")

   Dim beginval1 As Long
   Dim endval1 As Long
   
   beginval1 = 1
   endval1 = Val(Combo2.Text)
   
If UserHomeCheck = 0 Then GoTo Step161
If homedir = "cn=server1_Vol1,ou=OrganizationalUnit,o=Container#0#\Users_directory" Then GoTo Step161
          If (fso.FolderExists(MyPath)) Then GoTo Step1000 Else MkDir MyPath 'Make new directory or folder.
Step1000:
          ChDrive MyPath
          ChDir MyPath 'Changes the current directory or folder.
If endval = "1" Then GoTo Step150
      '***ProgressBar1.Min = beginval1
      '***ProgressBar1.Max = endval1
      '***ProgressBar1.Value = ProgressBar1.Min
      '***ProgressBar1.Visible = False

Step150:
      For j = beginval1 To endval1
         '***ProgressBar1.Value = j
   If userid1 = "" Then GoTo Step151
   If UserSetOneCheck = 0 Then GoTo Step151
      If (fso.FolderExists(MyPath + userid1 + Format(j))) Then GoTo CStep1 Else MkDir MyPath + userid1 + Format(j)  'Make new directory or folder.
CStep1:
      ChDir MyPath + userid1 + Format(j)
      If (fso.FolderExists(UHomeDir)) Then GoTo CStep2 Else MkDir UHomeDir  'Make new directory or folder.
CStep2:
      ChDir UHomeDir
      Open UHomeFile For Output As #2
      Print #2, userid1 + Format(j)
      ChDir "cd ..\.."
      Close #2
            
Step151:
   If userid2 = "" Then GoTo Step152
   If UserSetTwoCheck = 0 Then GoTo Step152
      If (fso.FolderExists(MyPath + userid2 + Format(j))) Then GoTo CStep3 Else MkDir MyPath + userid2 + Format(j) 'Make new directory or folder.
CStep3:
      ChDir MyPath + userid2 + Format(j)
      If (fso.FolderExists(UHomeDir)) Then GoTo CStep4 Else MkDir UHomeDir  'Make new directory or folder.
CStep4:
      ChDir UHomeDir
      Open UHomeFile For Output As #2
      Print #2, userid2 + Format(j)
      ChDir "cd ..\.."
      Close #2
         
Step152:
   If userid3 = "" Then GoTo Step153
   If UserSetThreeCheck = 0 Then GoTo Step153
      If (fso.FolderExists(MyPath + userid3 + Format(j))) Then GoTo CStep5 Else MkDir MyPath + userid3 + Format(j)  'Make new directory or folder.
CStep5:
      ChDir MyPath + userid3 + Format(j)
      If (fso.FolderExists(UHomeDir)) Then GoTo CStep6 Else MkDir UHomeDir  'Make new directory or folder.
CStep6:
      ChDir UHomeDir
      Open UHomeFile For Output As #2
      Print #2, userid3 + Format(j)
      ChDir "cd ..\.."
      Close #2
      
Step153:
   If userid4 = "" Then GoTo Step154
   If UserSetFourCheck = 0 Then GoTo Step154
      If (fso.FolderExists(MyPath + userid4 + Format(j))) Then GoTo CStep7 Else MkDir MyPath + userid4 + Format(j)  'Make new directory or folder.
CStep7:
      ChDir MyPath + userid4 + Format(j)
      If (fso.FolderExists(UHomeDir)) Then GoTo CStep8 Else MkDir UHomeDir  'Make new directory or folder.
CStep8:
      ChDir UHomeDir
      Open UHomeFile For Output As #2
      Print #2, userid4 + Format(j)
      ChDir "cd ..\.."
      Close #2
      
Step154:
      
If endval = "1" Then GoTo Step160
'***ProgressBar1.Visible = True
   Next j
      ChDir WPath
               
Step160:

     ChDrive "C:"
     ChDir App.Path
     
     MyVar = MsgBox("Directories have all been created.", 0, "Complete!")

Step161:

'End User Home Directory Creation Section
'***ProgressBar1.Visible = True
'***ProgressBar1.Value = ProgressBar1.Max

'This is the error handler
On Error GoTo ErrorResume   'Resume next in case file is locked
ErrorResume:
Resume Next   'in case file is locked
ErrorHandler:
If Err.Description = "" Then Resume Next Else MsgBox Err.Description

End Sub

Sub Shell32Bit(ByVal JobToDo As String)
    Dim hProcess As Long
    Dim RetVal As Long
    Dim WPath
    Dim IceLog As String
    Dim MyString
        
    WPath = Text19.Text
    IceLog = "ice.log"
    
On Error GoTo ErrorHandler
    
    hProcess = OpenProcess(PROCESS_QUERY_INFORMATION, False, Shell(JobToDo, 0)) 'The next line launches JobToDo as icon, captures process ID
    Do
       GetExitCodeProcess hProcess, RetVal 'Get the status of the process
            DoEvents: Sleep 1000 'Sleep command recommended as well as DoEvents

            Dim Num_Apps As Integer, NewFile As Integer
            Dim File_Data As String, DosCmd As String

            NewFile = FreeFile 'Display the filenames in the Text Box.
            Sleep 100
            
               Do While FileExists(WPath & IceLog) = "False" 'Make sure the file exists
               Sleep 1000
               Loop

                  Open (WPath & IceLog) For Input As #NewFile
                  ICE.Text1.Text = ""
                  While Not EOF(NewFile)
                  Line Input #NewFile, File_Data
                  ICE.Text1.Text = ICE.Text1.Text & File_Data & Chr(13) & Chr(10)
                  Wend
                  Close #NewFile
          
               Loop While RetVal = STILL_ACTIVE 'Loop while the process is active
               MyVar = MsgBox("The Update is Complete, Press OK to close the ICE Log or Cancel to review.", vbOKCancel, "Update Complete!")
               If MyVar = vbOK Then
               Unload ICE 'MsgBox ("OK Pressed")
               End If

On Error GoTo ErrorResume   'Resume next in case file is locked
ErrorResume:
Resume Next   'in case file is locked
ErrorHandler:
If Err.Description = "" Then Resume Next Else MsgBox Err.Description

End Sub
